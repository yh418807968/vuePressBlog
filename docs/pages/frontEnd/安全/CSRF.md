## 什么是CSRF
CSRF(Cross Site Request Forgery)，跨站请求伪造。名字非常好的概括了CSRF的攻击方式：黑客利用用户的登录状态（伪造），并通过第三方站点（跨站）做一些坏事（通过发起请求来实现）。

同时，我们也可以提炼出要实现CSRF需要满足的三要素：
* 1、用户要登录目标站点，并保持登录状态
* 2、需要打开一个第三方网站
* 3、目标站点服务器要存在漏洞（允许第三方站点访问）

## 如何发起CSRF攻击
根据以上分析的CSRF的三要素，大概有几种攻击方式。

### 自动发起GET请求
用户访问了黑客的网站页面，页面上的图片标签的地址为目标站点，直接发起get请求
### 自动发起POST请求
用户访问了黑客的网站页面，页面上带有表格，表格的提交地址为目标站点，通过立即执行的script代码发起post请求
### 引诱用户点击
一般是在论坛上发布一些引诱信息，比如美女照片之类，然后通过点击下载等方式引诱用户点击，最终向目标站点发起恶意请求。
（之类就是用户不需要访问黑客的网页，利用论坛等这类社交平台引诱用户直接发起）

## 如何防止CSRF攻击
针对CSRF的三要素，可以有一些解决方案
### 利用Cookie的SameSite
登录状态主要是通过Cookie识别，通过SameSite禁止第三方站点携带Cookie（也就是对目标站点的Cookie设置限制，在黑客网站上发起请求时，此Cookie不会被带上）
### 通过Refefer和Origin验证请求源
针对要素的第三点，可以通过服务器验证请求源来避免，不允许第三方站点访问之类的
### CSRF Token
浏览器发起请求时，服务器会返回一个Token，然后将该Token植入到返回的页面中（比如隐藏的input）, 浏览器如果要发起请求，，必须要带上这个Token，服务器会验证是否合法。
从第三方站点发起的请求，就没法拿到这个Token，所以即使发出了请求，服务器也会因为 CSRF Token 不正确而拒绝请求。